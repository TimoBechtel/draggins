{"version":3,"file":"index.module.js","sources":["../../node_modules/@compactjs/uea/dist/index.module.js","../../src/index.js"],"sourcesContent":["var r=function(r){return\"string\"==typeof r?Array.from(document.querySelectorAll(r)):Array.isArray(r)?r:void 0!==r.length?Array.from(r):[r]};export{r as accept};\n//# sourceMappingURL=index.module.js.map\n","import { accept } from '@compactjs/uea';\n\nconst isTouch = 'ontouchstart' in window;\nconst startEvent = isTouch ? 'touchstart' : 'mousedown';\nconst moveEvent = isTouch ? 'touchmove' : 'mousemove';\nconst endEvent = isTouch ? 'touchend' : 'mouseup';\n\nconst getDimensions = (element) => ({\n  width: element.offsetWidth,\n  height: element.offsetHeight,\n  top: element.offsetTop,\n  left: element.offsetLeft,\n});\n\nexport const draggable = (\n  element,\n  {\n    limit = {\n      x: { min: 0, max: window.innerWidth },\n      y: { min: 0, max: window.innerHeight },\n    },\n    cancelWhenOutOfBoundary = false,\n    dontTouchStyles = false,\n    onDragStart = () => {},\n    onDragEnd = () => {},\n  } = {}\n) => {\n  const elements = accept(element);\n  let draggable = true;\n  elements.forEach((element) => {\n    if (!dontTouchStyles) initStyles(element);\n    const translate = { x: 0, y: 0 };\n    element.addEventListener(startEvent, (e) => {\n      const event = /touch/.test(e.type) ? e.targetTouches[0] : e;\n      const dimensions = getDimensions(element);\n\n      const initialMousePosition = {\n        x: event.clientX,\n        y: event.clientY,\n      };\n      const initialTranslate = { ...translate };\n      onDragStart({\n        x: dimensions.left + translate.x,\n        y: dimensions.top + translate.y,\n      });\n      e.preventDefault();\n\n      document.addEventListener(moveEvent, onMouseMove);\n      document.addEventListener(endEvent, onMouseUp);\n\n      function onMouseMove(e) {\n        if (!draggable) return;\n        const event = /touch/.test(e.type) ? e.targetTouches[0] : e;\n        if (\n          cancelWhenOutOfBoundary &&\n          isOutOfBoundary(event.clientX, event.clientY, limit)\n        ) {\n          removeListener(onMouseMove, onMouseUp);\n          return;\n        }\n        const mouseMoveDistance = {\n          x: event.clientX - initialMousePosition.x,\n          y: event.clientY - initialMousePosition.y,\n        };\n        translate.x = initialTranslate.x + mouseMoveDistance.x;\n        translate.y = initialTranslate.y + mouseMoveDistance.y;\n\n        if (limit) {\n          translate.x = limitValue(\n            translate.x,\n            limit.x.min - dimensions.left,\n            limit.x.max - dimensions.width - dimensions.left\n          );\n          translate.y = limitValue(\n            translate.y,\n            limit.y.min - dimensions.top,\n            limit.y.max - dimensions.height - dimensions.top\n          );\n        }\n\n        element.style.transform = `translate(${translate.x}px, ${translate.y}px)`;\n      }\n      function onMouseUp() {\n        onDragEnd({\n          x: dimensions.left + translate.x,\n          y: dimensions.top + translate.y,\n        });\n        removeListener(onMouseMove, onMouseUp);\n      }\n    });\n  });\n  return {\n    setDraggableState(state) {\n      draggable = state;\n    },\n  };\n};\n\nconst initStyles = (element) => {\n  element.style.zIndex = 99;\n};\n\nconst limitValue = (value, from, to) => {\n  return Math.min(Math.max(value, from), to);\n};\n\nconst isOutOfBoundary = (x, y, limit) =>\n  !limit ||\n  x <= limit.x.min ||\n  x >= limit.x.max ||\n  y <= limit.y.min ||\n  y >= limit.y.max;\n\nconst removeListener = (onMouseMove, onMouseUp) => {\n  document.removeEventListener(moveEvent, onMouseMove);\n  document.removeEventListener(endEvent, onMouseUp);\n};\n"],"names":["isTouch","window","startEvent","moveEvent","endEvent","draggable","element","r","limit","x","min","max","innerWidth","y","innerHeight","cancelWhenOutOfBoundary","dontTouchStyles","onDragStart","onDragEnd","elements","Array","from","document","querySelectorAll","isArray","length","forEach","initStyles","translate","addEventListener","e","event","test","type","targetTouches","dimensions","width","offsetWidth","height","offsetHeight","top","offsetTop","left","offsetLeft","getDimensions","initialMousePosition","clientX","clientY","initialTranslate","onMouseMove","isOutOfBoundary","removeListener","onMouseUp","mouseMoveDistance","limitValue","style","transform","preventDefault","setDraggableState","state","zIndex","value","to","Math","removeEventListener"],"mappings":"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"}