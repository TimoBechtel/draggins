{"version":3,"file":"index.module.js","sources":["../../node_modules/@compactjs/uea/dist/index.module.js","../../src/index.js"],"sourcesContent":["var r=function(r){return\"string\"==typeof r?Array.from(document.querySelectorAll(r)):Array.isArray(r)?r:void 0!==r.length?Array.from(r):[r]};export{r as accept};\n//# sourceMappingURL=index.module.js.map\n","import { accept } from '@compactjs/uea';\n\nconst isTouch = 'ontouchstart' in window;\nconst startEvent = isTouch ? 'touchstart' : 'mousedown';\nconst moveEvent = isTouch ? 'touchmove' : 'mousemove';\nconst endEvent = isTouch ? 'touchend' : 'mouseup';\n\nconst getDimensions = (element) => ({\n  width: element.offsetWidth,\n  height: element.offsetHeight,\n  top: element.offsetTop,\n  left: element.offsetLeft,\n});\n\nexport const draggable = (\n  element,\n  {\n    limit = {\n      x: { min: 0, max: window.innerWidth },\n      y: { min: 0, max: window.innerHeight },\n    },\n    cancelWhenOutOfBoundary = false,\n    dontTouchStyles = false,\n    onDragStart = () => {},\n    onDragEnd = () => {},\n  } = {}\n) => {\n  const elements = accept(element);\n  let draggable = true;\n  elements.forEach((element) => {\n    if (!dontTouchStyles) initStyles(element, getDimensions(element));\n    element.addEventListener(startEvent, (e) => {\n      const event = /touch/.test(e.type) ? e.targetTouches[0] : e;\n      const dimensions = getDimensions(element);\n      const mouseStartPosition = {\n        x: event.clientX,\n        y: event.clientY,\n      };\n      onDragStart({ x: dimensions.left, y: dimensions.top });\n      e.preventDefault();\n      function onMouseMove(e) {\n        if (!draggable) return;\n        const event = /touch/.test(e.type) ? e.targetTouches[0] : e;\n        if (\n          cancelWhenOutOfBoundary &&\n          isOutOfBoundary(event.clientX, event.clientY, limit)\n        ) {\n          removeListener(onMouseMove, onMouseUp);\n          return;\n        }\n        const mouseMoveDistance = {\n          x: event.clientX - mouseStartPosition.x,\n          y: event.clientY - mouseStartPosition.y,\n        };\n        let newElementTop = dimensions.top + mouseMoveDistance.y;\n        if (limit)\n          newElementTop = limitValue(\n            newElementTop,\n            limit.y.min,\n            limit.y.max - dimensions.height\n          );\n        let newElementLeft = dimensions.left + mouseMoveDistance.x;\n        if (limit)\n          newElementLeft = limitValue(\n            newElementLeft,\n            limit.x.min,\n            limit.x.max - dimensions.width\n          );\n        element.style.top = `${newElementTop}px`;\n        element.style.left = `${newElementLeft}px`;\n      }\n      function onMouseUp() {\n        onDragEnd({ x: dimensions.left, y: dimensions.top });\n        removeListener(onMouseMove, onMouseUp);\n      }\n      document.addEventListener(moveEvent, onMouseMove);\n      document.addEventListener(endEvent, onMouseUp);\n    });\n  });\n  return {\n    setDraggableState(state) {\n      draggable = state;\n    },\n  };\n};\n\nconst initStyles = (element, { top, left, width, height }) => {\n  element.style.top = `${top}px`;\n  element.style.left = `${left}px`;\n  element.style.width = `${width}px`;\n  element.style.height = `${height}px`;\n  element.style.position = 'absolute';\n  element.style.zIndex = 99;\n};\n\nconst limitValue = (value, from, to) => {\n  return Math.min(Math.max(value, from), to);\n};\n\nconst isOutOfBoundary = (x, y, limit) =>\n  !limit ||\n  x <= limit.x.min ||\n  x >= limit.x.max ||\n  y <= limit.y.min ||\n  y >= limit.y.max;\n\nconst removeListener = (onMouseMove, onMouseUp) => {\n  document.removeEventListener(moveEvent, onMouseMove);\n  document.removeEventListener(endEvent, onMouseUp);\n};\n"],"names":["isTouch","window","startEvent","moveEvent","endEvent","getDimensions","element","width","offsetWidth","height","offsetHeight","top","offsetTop","left","offsetLeft","draggable","r","limit","x","min","max","innerWidth","y","innerHeight","cancelWhenOutOfBoundary","dontTouchStyles","onDragStart","onDragEnd","elements","Array","from","document","querySelectorAll","isArray","length","forEach","initStyles","addEventListener","e","event","test","type","targetTouches","dimensions","mouseStartPosition","clientX","clientY","onMouseMove","isOutOfBoundary","removeListener","onMouseUp","mouseMoveDistance","newElementTop","limitValue","newElementLeft","style","preventDefault","setDraggableState","state","position","zIndex","value","to","Math","removeEventListener"],"mappings":"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"}